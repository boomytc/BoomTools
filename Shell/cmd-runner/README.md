# SSH脚本执行器 - 轻量版

基于PySide6的轻量化SSH远程命令执行工具，专注于核心功能，简单易用。

## 功能特点

- **SSH连接管理**: 快速连接SSH服务器，支持连接历史记录
- **命令执行**: 执行远程命令并实时显示结果，支持命令历史记录
- **智能输入**: 命令历史自动完成，提高输入效率
- **输出分离**: 标准输出和错误输出分别显示，带时间戳
- **配置保存**: 自动保存连接配置和最后使用的连接
- **快捷键支持**: 丰富的快捷键操作，提高使用效率
- **简洁界面**: 单窗口设计，操作简单直观

## 技术栈

- **PySide6**: 现代化GUI界面
- **Paramiko**: SSH连接和命令执行

## 项目结构

```
cmd-runner/
├── main.py             # 主程序(包含所有功能)
├── config.json         # 配置文件(自动生成在同目录)
├── demo.py             # 功能演示脚本(可选)
├── requirements.txt    # 依赖库
└── README.md          # 项目说明
```

## 快速开始

### 方法一：直接使用
```bash
pip install -r requirements.txt
python main.py
```

### 方法二：演示模式
```bash
pip install -r requirements.txt
python demo.py  # 生成示例配置和数据
python main.py  # 启动程序，可体验预设功能
```

## 安装依赖

```bash
pip install -r requirements.txt
```

## 运行方式

```bash
python main.py
```

## 使用说明

1. **连接配置**
   - 在连接配置区域输入SSH信息（主机、端口、用户名、密码）
   - 可从下拉列表选择历史连接记录
   - 点击"连接"按钮连接到远程服务器

2. **命令执行**
   - 在命令输入框中输入要执行的命令
   - 点击"执行"按钮或按回车键执行命令
   - 支持所有标准的shell命令

3. **结果查看**
   - 左侧显示标准输出
   - 右侧显示错误输出
   - 点击"清空输出"可清理显示内容

4. **快捷键操作**
   - `F5`: 连接到SSH服务器
   - `Ctrl+Enter`: 执行命令
   - `Ctrl+L`: 清空输出
   - `Ctrl+D`: 断开连接
   - `Escape`: 清空命令输入框

5. **智能功能**
   - 命令输入支持历史记录自动完成
   - 输出显示时间戳
   - 自动保存最近50条命令历史

## 新版本特点

### 与原版本相比的改进：

1. **极简架构**: 从15个文件精简到1个主文件
2. **轻量设计**: 移除复杂的状态监控、多窗口管理等功能
3. **更好的用户体验**: 
   - 连接历史下拉选择
   - 实时状态显示
   - 线程化执行，界面不卡顿
4. **维护友好**: 代码结构清晰，易于理解和修改

### 保留的核心功能：

- SSH连接管理
- 命令执行
- 结果显示
- 配置保存
- 基本错误处理

### 简化/移除的功能：

- 复杂的命令状态监控
- 多窗口管理
- 实时命令输出监控
- PID管理
- 复杂的日志系统

## 配置文件

程序会自动生成`config.json`文件，包含：

```json
{
  "connections": [
    {
      "host": "服务器地址",
      "port": 22,
      "username": "用户名",
      "password": "密码"
    }
  ],
  "last_connection": {
    "host": "最后连接的服务器",
    "port": 22,
    "username": "用户名",
    "password": "密码"
  },
  "command_history": [
    "最近执行的命令1",
    "最近执行的命令2"
  ],
  "ui_settings": {
    "font_size": 12,
    "max_history": 50
  }
}
```

## 注意事项

- 密码以明文形式保存在配置文件中，请注意安全性
- 程序支持大部分标准shell命令
- 交互式命令（如vi、top等）可能无法正常工作
- 建议在稳定的网络环境下使用
